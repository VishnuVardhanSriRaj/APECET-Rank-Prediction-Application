<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rank Prediction Application</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 600px;
            margin: 50px auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #333;
        }

        form {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        button {
            padding: 10px 20px;
            background-color: #4caf50;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        #predictedRank {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-top: 20px;
        }

        .error {
            color: red;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Rank Prediction Application</h1>
    
    <form id="rankPredictionForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>
        <label for="rollNumber">Roll Number (Format: XXXXX-XX-XXX):</label>
        <input type="text" id="rollNumber" name="rollNumber" pattern="[A-Za-z0-9]{5}-[A-Za-z0-9]{2}-[A-Za-z0-9]{3}" title="Please enter in the format: XXXXX-XX-XXX" required>
        <label for="marks">Marks (Max 200):</label>
        <input type="number" id="marks" name="marks" min="0" max="200" required>
        <label for="branch">Branch:</label>
        <select id="branch" name="branch" required>
            <option value="CSE">CSE</option>
            <option value="ECE">ECE</option>
            <option value="Mech">Mechanical</option>
            <option value="EEE">EEE</option>
           <!--Departments Selcetion-->
        </select>
        <label for="caste">Caste:</label>
        <select id="caste" name="caste" required>
            <option value="OC">OC</option>
            <option value="BC">BC</option>
            <option value="SC">SC</option>
            <option value="ST">ST</option>
        </select>
        <label for="mobileNumber">Mobile Number (10 digits):</label>
        <input type="text" id="mobileNumber" name="mobileNumber" pattern="[0-9]{10}" title="Please enter 10 digits" required>
        <button type="button" onclick="predictRank()">Predict Rank</button>
    </form>

    <div id="predictedRank"></div>
</div>

<script>
    function predictRank() {
        const name = document.getElementById('name').value;
        const rollNumber = document.getElementById('rollNumber').value;
        const marks = parseInt(document.getElementById('marks').value);
        const branch = document.getElementById('branch').value;
        const caste = document.getElementById('caste').value;
        const mobileNumber = document.getElementById('mobileNumber').value;

        // Validataion rule for  mobile number
        const mobileRegex = /^[0-9]{10}$/;
        if (!mobileRegex.test(mobileNumber)) {
            showError("Mobile number must be 10 digits");
            return;
        }

        // Validataioni for  marks
        if (marks > 200) {
            showError("Marks cannot be above 200");
            return;
        }

        let rank;

        //  rank prediction based on marks and branch
        if (branch === 'CSE') {
            if (marks >= 150) {
                rank = '1 to 10';
            } else if (marks >= 140) {
                rank = '11 to 20';
            } else if (marks >= 130) {
                rank = '21 to 30';
            }else if (marks >= 120) {
                rank = '31 to 40';
            }else if (marks >= 110) {
                rank = '41 to 50';
            }else if (marks >= 100) {
                rank = '51 to 60';
            }else if (marks >= 90) {
                rank = '61 to 100';
            }else if (marks >= 80) {
                rank = '101 to 150';
            }else if (marks >= 70) {
                rank = '151 to 250';
            }else if (marks >= 60) {
                rank = '251 to 500';
            }else if (marks >= 50) {
                rank = '501 to 1000';
            }else if (marks >= 40) {
                rank = 'Above 1000';
            }

        }
        // Implement logic for other branches...

        // Additional logic based on caste
        if ((caste === 'SC' || caste === 'ST') && marks < 50) {
            rank = '2000 above';
        } else if ((caste === 'OC' || caste === 'BC') && marks < 50) {
            rank = 'Not qualified';
        } else if ((caste === 'OC' || caste === 'BC') && marks <= 50) {
            rank = '2000 above';
        }

        const predictedRank = `Predicted Rank: ${rank}`;
        document.getElementById('predictedRank').innerText = predictedRank;

        // POST details to the server
        const predictionDetails = {
            name: name,
            rollNumber: rollNumber,
            marks: marks,
            branch: branch,
            caste: caste,
            mobileNumber: mobileNumber,
            predictedRank: rank
        };
        saveToServer(predictionDetails);
    }

    function saveToServer(predictionDetails) {
        // POST Details to the server using fetch API
        fetch('save-prediction.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(predictionDetails)
        })
        .then(response => {
            if (response.ok) {
                console.log('Prediction details saved successfully');
            } else {
                console.error('Failed to save prediction details');
            }
        })
        .catch(error => {
            console.error('Error saving prediction details:', error);
        });
    }

    function showError(message) {
        const errorDiv = document.createElement('div');
        errorDiv.classList.add('error');
        errorDiv.textContent = message;
        document.getElementById('predictedRank').innerHTML = '';
        document.getElementById('predictedRank').appendChild(errorDiv);
    }
</script>

</body>
</html>
